<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>X(Twitter)・TikTok動画ダウンローダー</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
            max-width: 600px;
            margin: auto;
        }
        input[type="text"] {
            width: 100%;
            padding: 8px;
            margin-top: 8px;
        }
        button {
            padding: 10px 16px;
            margin-top: 15px;
            width: 100%;
        }
        label {
            display: block;
            margin-top: 10px;
        }
        pre {
            background: #f5f5f5;
            padding: 10px;
            margin-top: 15px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>

<h2>X(Twitter)・TikTok動画ダウンローダー</h2>

<input type="text" id="url" placeholder="https://x.com/...">

<label>
    <input type="checkbox" id="replace_x" checked>
    URLのX.comを twitter.com に置換する（推奨・yt-dlp対策）
</label>

<label>
    <input type="checkbox" id="audio_only">
    音声のみでダウンロード（動画なし）
</label>

<button onclick="download()">ダウンロード</button>

<p style="margin-top: 15px;">
    使いすぎないでください。<br>
    <b>動画・音声は2分後に自動削除</b>され、ダウンロードできなくなります。<br>
    <b style="color:red">※ YouTube は未対応です。</b><br><br>
<b>対応済みサイト：</b><br>
<a href="https://www.google.com/search?q=site%3Afacebook.com">Facebook</a>、
<a href="https://www.google.com/search?q=site%3Ainstagram.com">Instagram</a>、
<a href="https://www.google.com/search?q=site%3Ax.com">Twitter（X）</a>、
<a href="https://www.google.com/search?q=site%3Atiktok.com">TikTok</a>、
<a href="https://www.google.com/search?q=site%3Avimeo.com">Vimeo</a>、
<a href="https://www.google.com/search?q=site%3Adailymotion.com">Dailymotion</a>、
<a href="https://www.google.com/search?q=site%3Atwitch.tv">Twitch</a>、
<a href="https://www.google.com/search?q=site%3Anicovideo.jp">ニコニコ動画</a>、
<a href="https://www.google.com/search?q=site%3Abilibili.com">bilibili</a>、
<a href="https://www.google.com/search?q=site%3Areddit.com">Reddit</a>、
<a href="https://www.google.com/search?q=site%3Avevo.com">Vevo</a>、
<a href="https://www.google.com/search?q=site%3Apornhub.com">Pornhub</a>、
<a href="https://www.google.com/search?q=site%3Axvideos.com">XVideos</a>、
<a href="https://www.google.com/search?q=site%3Axnxx.com">XNXX</a>、
<a href="https://www.google.com/search?q=site%3Asoundcloud.com">SoundCloud</a>、
<a href="https://www.google.com/search?q=site%3Aimgur.com">Imgur</a>、
<a href="https://www.google.com/search?q=site%3Avk.com">VK（VKontakte）</a>、
<a href="https://www.google.com/search?q=site%3Aweibo.com">Weibo（微博）</a>、
<a href="https://www.google.com/search?q=site%3Aarchive.org">archive.org</a>、
<a href="https://www.google.com/search?q=site%3Ated.com">TED</a>、
<a href="https://www.google.com/search?q=site%3Aamazon.in">AmazonMiniTV</a>、
<a href="https://www.google.com/search?q=site%3Atrailers.apple.com">AppleTrailers</a>、
<a href="https://www.google.com/search?q=site%3Acrunchyroll.com">Crunchyroll</a>、
<a href="https://www.google.com/search?q=site%3Aacfun.cn">AcFun（AcFunVideo）</a>、
<a href="https://www.google.com/search?q=site%3Aaparat.com">Aparat</a>、
<a href="https://www.google.com/search?q=site%3A9gag.com">9GAG</a>、
<a href="https://www.google.com/search?q=site%3Aabema.tv">AbemaTV</a>、
<a href="https://www.google.com/search?q=site%3Abbc.co.uk">BBC</a>、
<a href="https://www.google.com/search?q=site%3Ahulu.com">Hulu</a>、Po〇nH〇b、Xv〇eo〇、XHa〇st〇r、XN〇Xなど。
</p>

<pre id="result"></pre>

<script>
async function download() {
    const url = document.getElementById("url").value.trim();
    const replaceX = document.getElementById("replace_x").checked;
    const audioOnly = document.getElementById("audio_only").checked ? 1 : 0;

    document.getElementById("result").textContent = "処理中です…";

    try {
        const res = await fetch("/api/download", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                url: url,
                replace_x: replaceX,
                audio_only: audioOnly
            })
        });

        const data = await res.json();

        if (data.status === "ok" && data.download_url) {
            // 自動ダウンロード開始
            window.location.href = data.download_url;
            document.getElementById("result").textContent =
                "ダウンロードを開始しました: " + data.filename;
        } else {
            document.getElementById("result").textContent =
                JSON.stringify(data, null, 2);
        }
    } catch (e) {
        document.getElementById("result").textContent =
            "通信エラー: " + e;
    }
}
</script>

</body>
</html>
